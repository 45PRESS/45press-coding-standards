<?xml version="1.0"?>
<ruleset name="45PCS">

	<description>PHP Coding Guidelines</description>

	<autoload>./vendor/wp-coding-standards/wpcs/WordPress/PHPCSAliases.php</autoload>

	<exclude-pattern>*/tests/*</exclude-pattern>
	<exclude-pattern>*/vendor/*</exclude-pattern>
	<exclude-pattern>\.git</exclude-pattern>

	<arg name="report" value="summary"/>
	<arg name="colors"/>
	<arg value="sp"/>

	<rule ref="WordPress">
		<exclude name="Squiz.Commenting.FileComment.MissingPackageTag"/>
		<exclude name="WordPress.Arrays.MultipleStatementAlignment.DoubleArrowNotAligned"/>
		<exclude name="WordPress.NamingConventions.ValidVariableName.NotSnakeCase"/>
		<exclude name="WordPress.NamingConventions.ValidVariableName.NotSnakeCaseMemberVar"/>
		<exclude name="WordPress.NamingConventions.ValidVariableName.MemberNotSnakeCase"/>
		<exclude name="WordPress.PHP.YodaConditions.NotYoda"/>
		<exclude name="WordPress.Files.FileName.NotHyphenatedLowercase"/>
		<exclude name="WordPress.Files.FileName.InvalidClassFileName"/>
		<exclude name="Generic.Formatting.MultipleStatementAlignment.NotSameWarning"/>
		<exclude name="Generic.Formatting.SpaceAfterCast.NoSpace"/>
		<exclude name="WordPress.WhiteSpace.CastStructureSpacing.NoSpaceAfterCloseParenthesis"/>
		<exclude name="WordPress.WP.PostsPerPage.posts_per_page_posts_per_page"/>
		<exclude name="WordPress.Security.NonceVerification.NoNonceVerification"/>
		<exclude name="WordPress.Security.ValidatedSanitizedInput.InputNotValidated"/>
		<exclude name="WordPress.Security.ValidatedSanitizedInput.InputNotSanitized"/>
		<exclude name="WordPress.Security.ValidatedSanitizedInput.MissingUnslash"/>
		<exclude name="WordPress.WP.EnqueuedResources.NonEnqueuedStylesheet"/>
		<exclude name="WordPress.WP.EnqueuedResources.NonEnqueuedScript"/>
	</rule>

	<rule ref="WordPressVIPMinimum">
		<exclude name="WordPress.VIP.AdminBarRemoval.RemovalDetected"/>
		<exclude name="WordPressVIPMinimum.Files.IncludingFile.IncludingFile"/>
		<exclude name="WordPress.VIP.SuperGlobalInputUsage.AccessDetected"/>
		<exclude name="WordPressVIPMinimum.VIP.RestrictedFunctions.custom_role_add_role"/>
		<exclude name="WordPressVIPMinimum.VIP.RestrictedFunctions.wp_remote_get_wp_remote_get"/>
		<exclude name="WordPress.VIP.ValidatedSanitizedInput.InputNotValidated"/>
		<exclude name="WordPress.VIP.ValidatedSanitizedInput.InputNotSanitized"/>
	</rule>

	<!-- Things that probably won't work and needs a dev to review -->
	<rule ref="WordPress.VIP.FileSystemWritesDisallow.file_ops_fwrite">
		<type>error</type>
		<severity>6</severity>
		<message>File system writes only work in /tmp/ and inside the /uploads/ folder on VIP Go. To do filesystem writes you must use the WP_Filesystem class, using functions such as %s() won't work or will return unexpected results.</message>
	</rule>
	<rule ref="WordPress.WP.AlternativeFunctions.file_system_read_fwrite">
		<type>error</type>
		<severity>5</severity>
		<message>File system writes only work in /tmp/ and inside the /uploads/ folder on VIP Go. To do filesystem writes you must use the WP_Filesystem class, using functions such as %s() won't work or will return unexpected results.</message>
	</rule>
	<!--
	Things that really should be fixed, but don't nessesarily have to be for the site to work.
	This includes potential security holes as well as functions for performance reasons.
	-->
	<rule ref="WordPressVIPMinimum.VIP.RestrictedFunctions.file_get_contents_file_get_contents">
		<type>error</type>
		<Severity>5</Severity>
		<message>%s() is uncached. If this is being used to query a remote file please use wpcom_vip_file_get_contents() instead. If it's used for a local file please use WP_Filesystem instead. Read more here:</message>
	</rule>
	<rule ref="WordPress.WP.AlternativeFunctions.file_system_read_file_get_contents">
		<type>error</type>
		<Severity>5</Severity>
		<message>%s() is uncached. If this is being used to query a remote file please use wpcom_vip_file_get_contents() instead. If it's used for a local file please use WP_Filesystem instead.</message>
	</rule>
	<rule ref="WordPressVIPMinimum.VIP.FetchingRemoteData.fileGetContentsUknown">
		<type>error</type>
		<Severity>5</Severity>
		<message>%s() is uncached. If this is being used to query a remote file please use wpcom_vip_file_get_contents() instead. If it's used for a local file please use WP_Filesystem instead.</message>
	</rule>
	<rule ref="WordPress.WP.AlternativeFunctions.file_system_read_fopen">
		<type>error</type>
		<severity>5</severity>
		<message>File operations should use WP_Filesystem methods instead of direct PHP filesystem calls. Found: %s().</message>
	</rule>
	<rule ref="WordPress.WP.AlternativeFunctions.file_system_read_fclose">
		<type>error</type>
		<severity>5</severity>
		<message>File operations should use WP_Filesystem methods instead of direct PHP filesystem calls. Found: %s().</message>
	</rule>
	<rule ref="WordPress.Security.EscapeOutput.UnsafePrintingFunction">
		<type>error</type>
		<severity>5</severity>
	</rule>
	<rule ref="WordPress.Security.EscapeOutput.OutputNotEscaped">
		<type>error</type>
		<severity>5</severity>
	</rule>
	<rule ref="WordPressVIPMinimum.VIP.ExitAfterRedirect.NoExit">
		<type>error</type>
		<severity>5</severity>
	</rule>
	<rule ref="WordPressVIPMinimum.VIP.ProperEscapingFunction.hrefSrcEscUrl">
		<type>error</type>
		<severity>5</severity>
	</rule>
	<rule ref="WordPressVIPMinimum.VIP.WPQueryParams.suppressFiltersTrue">
		<type>error</type>
		<severity>5</severity>
	</rule>
	<rule ref="WordPressVIPMinimum.JS.HTMLExecutingFunctions.append">
		<type>error</type>
		<severity>5</severity>
	</rule>
	<rule ref="WordPressVIPMinimum.JS.InnerHTML.innerHTML">
		<type>error</type>
		<severity>5</severity>
	</rule>
	<rule ref="WordPressVIPMinimum.JS.StringConcat.StringConcatNext">
		<type>error</type>
		<severity>5</severity>
	</rule>
	<rule ref="Generic.NamingConventions.ConstructorName.OldStyle">
		<type>error</type>
		<severity>5</severity>
		<message>This is currently deprecated in PHP 7.0 and will be removed in the future. This will cause a fatal error on newer versions of PHP and should be fixed.</message>
	</rule>

	<rule ref="Squiz.Scope.MemberVarScope"/>
	<rule ref="Squiz.Scope.MethodScope"/>
	<rule ref="Squiz.Scope.StaticThisUsage"/>
	<rule ref="Squiz.WhiteSpace.CastSpacing"/>
	<rule ref="PEAR.NamingConventions.ValidClassName"/>
	<rule ref="Squiz.Functions.FunctionDeclaration"/>
	<rule ref="PEAR.Functions.ValidDefaultValue"/>
	<rule ref="PSR2.Namespaces.NamespaceDeclaration"/>
	<rule ref="PSR2.Namespaces.UseDeclaration"/>
	<rule ref="Generic.Arrays.DisallowLongArraySyntax"/>
	<rule ref="Squiz.Classes.LowercaseClassKeywords"/>
	<rule ref="Generic.CodeAnalysis.ForLoopShouldBeWhileLoop"/>
	<rule ref="Generic.CodeAnalysis.ForLoopWithTestFunctionCall"/>
	<rule ref="Generic.CodeAnalysis.JumbledIncrementer"/>
	<rule ref="Generic.CodeAnalysis.UnconditionalIfStatement"/>
	<rule ref="Generic.CodeAnalysis.UnnecessaryFinalModifier"/>

	<config name="testVersion" value="7.0-"/>
	<rule ref="PHPCompatibility"/>

</ruleset>
